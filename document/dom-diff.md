## DOM Diff

`Vue`创建视图分为俩种情况：

1. 首次渲染，会用组件`template`转成的真实`DOM`来替换应用中的根元素
2. 当数据更新后，视图重新渲染，此时并不会重新通过组件`template`对应的虚拟节点来创建真实`DOM`，而是会用老的虚拟节点和新的虚拟节点进行比对，根据比对结果来更新`DOM`

第二种情况就是`Vue`中经常谈到的`DOM Diff`，接下来我们将详细介绍新老节点的比对过程。

### 整体思路

老的虚拟节点和新的虚拟节点是俩棵树，会对俩棵树每层中的虚拟节点进行比对操作：
![](https://raw.githubusercontent.com/wangkaiwd/drawing-bed/master/20210115153619.png)

在每一层进行对比时，会分别为老节点和新节点设置头尾指针:
![](https://raw.githubusercontent.com/wangkaiwd/drawing-bed/master/20210115155351.png)

整体的孩子节点比对思路如下：

* 在老的虚拟节点和新的虚拟节点的头尾指针之间都有元素时进行遍历
* 对以下情况进行优化
  * 老节点的头指针和新节点的头指针相同
  * 老节点的尾指针和新节点的尾指针相同
  * 老节点的头指针和新节点的尾指针相同
  * 老节点的尾指针和新节点的头指针相同
* 乱序排列时，要用新节点的头节点到老节点中查找，如果能找到，对其复用并移动到相应的位置。如果没有找到，将其插入到真实节点中
* 遍历完成后，将新节点头指针和尾指针之间的元素插入到真实节点中，老节点头指针和尾指针之间的元素删除

下面我们用代码进行实现

### 处理简单情况

### 比对优化

### 乱序比对
